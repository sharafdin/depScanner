use reqwest::Client;

pub async fn check_vulnerabilities(package_name: &str, version: &str) -> Option<String> {
    let url = format!("https://registry.npmjs.org/-/npm/v1/security/advisories");
    let client = Client::new();
    let response = client
        .post(&url)
        .json(&serde_json::json!({ "name": package_name, "version": version }))
        .send()
        .await
        .ok()?;

    if response.status().is_success() {
        let advisory: serde_json::Value = response.json().await.ok()?;
        Some(advisory["title"].as_str()?.to_string())
    } else {
        None
    }
}
